---
title: "Final Project"
author: "Tim Lanthier"
date: "3/12/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(knitr)
library(patchwork)
library(broom)
library(leaps)
library(Hmisc)
library(corrplot)
library(RColorBrewer)
```

## Introduction

```{r echo = FALSE}
youtube_raw <- read.csv('data/youtube_data.csv') %>%
  subset(select = -c(X)) %>%
  mutate(trending_date = as.Date(trending_date),  # strip time since all trending dates recorded at time 0
         publishedAt = as.POSIXct(publishedAt),
         weekday_published = as.factor(weekday_published))

youtube_raw$desc_length[is.na(youtube_raw$desc_length)] <- 0
youtube_raw <- youtube_raw %>%
  drop_na()

levels(youtube_raw$weekday_published) = c('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday','Sunday')


youtube <- youtube_raw %>%
  subset(select = -c(video_id, channelId, categoryId, tags, description, title, trending_date, likes, dislikes, comment_count, trending_age, channelTitle))
```

  For content creators on Youtube, their income is largely determined by the popularity of their videos. The most obvious source of income for creators is revenue from ads. The more views your video gets, the more ads are served and the more a creator might get paid. Additionally, higher view counts on videos may result in sponsorship deals for creators which serve an additional source of income. Hence, it is important for creators on Youtube to maximize the number of views that they get on videos. Of course the success of a Youtube video depends on the content in the video itself, but how much is the view count of a video associated with other aspects such as the title or time of upload?
  
In this paper, we will explore how certain characteristics of trending Youtube videos are associated with view count. We wish to find what aspects of a video such as length of the title or time of upload may be associated with the view count a Youtube video.

The dataset was obtained through [Kaggle](https://www.kaggle.com/rsrishav/youtube-trending-video-dataset?select=US_youtube_trending_data.csv) and includes as observations all trending videos from August of 2020 to now from a variety of regions. For this analysis, we will only be using trending videos from the US. Note that the dataset we will be using was accessed from Kaggle on February 7, 2022, so we will only include trending Youtube videos up to that date. From this dataset, we have taken a random sample of 1000 videos and have generated some additional variables from the dataset. We also used the Youtube API with the provided video and channel IDs to gain additional potential predictors such as video length and subscriber counts for the channels. Our feature generation procedure left us with a few different missing values. There were some missing subscriber counts as well as video lengths due to videos and channels no longer existing. Since there were very few of those observations, we have removed them from our dataset. Additionaly, some videos had no description leading to missing values. So for those videos we imputed the description length of be 0 characters. 

We also removed variables such as `likes`, `dislikes`, and `trending_age` since those values would not be observed until after the video is uploaded. Since we want to look at variables which can only be observed before the video is uploaded, those will not be important for our analysis. This leaves us with a dataset with 973 observations and the following 20 variables:

|Variable|Description|
|---|---|
|publishedAt | date and time of upload (PST)|
|view_count| number of views|
|comments_disabled| comments are disabled (T/F)|
|ratings_disabled| ratings are disabled (T/F)|
|num_tags| number of tags in video|
|num_caps| number of capital letters in title|
|num_exc| number of exclamation points in title|
|num_qm| number of question marks in title|
|num_period| number of periods in title|
|num_dollar| number of dollar signs in title|
|title_length| length of title in characters|
|desc_length| length of description in characters|
|channel_length| length of channel name in characters|
|weekday_published| weekday of video upload|
|day_published| day of month video was uploaded|
|hour_published| hour of day video was published|
|video_length| length of video in seconds|
|subscriberCount| number of subscribers on publisher's channel|
|videoCount| number of videos on publisher's channel|
|category| video category|
   
Looking at the response variable of view count, we find that the distribution for view count has a heavy positive skew. Since we wish to conduct inference on our model, we will instead be using the logarithm of view count so as to have a more normally distributed response variable. The distributions for both variables are shown below.

```{r echo = FALSE}
youtube <- youtube %>% 
  mutate(log_views = log(view_count))

p1<- ggplot(data = youtube, aes(view_count)) +
  geom_histogram(bins = 50)+
  labs(x = 'View Count', title = 'Distribution of View Count')

p2<- ggplot(data = youtube, aes(log_views)) +
  geom_histogram(bins = 50)+
  labs(x = 'Log View Count', title = 'Distribution of Log View Count')

p1+p2
```

Interestingly, looking at the plots for log view count against the number of tags, we see what appears to be a completely random scatter. So there appears to be no relationship between log view count and the number of tags a video has. This is quite surprising as I would expect a large number of tags might result in the video getting suggested to more users and thus more people viewing the video.
```{r echo = FALSE}
ggplot(data = youtube, aes(x = num_tags, y = log_views)) +
  geom_point() +
  labs(x = 'Number of Tags', y = 'Log Views', title = 'Number of Tags vs Log View Count')
```

Meanwhile looking at the box plots for log view count across the categories of videos, we find that there are some large differences in log view count across the different video categories. While the variability varies between the categories, just looking at the means, we have comedy and SciFi/Fantasy videos appears to be the most popular while foreign, horror, and music videos appear to have the lowest mean log view counts. So video category may be useful in our model. What seemed unusual is that videos in the Music category have such a low mean log view count. Just based off my own observations of trending videos, it seems that music videos which hit trending tend to have pretty high view counts.

```{r echo=FALSE}
ggplot(data = youtube, aes(x = category, y = log_views)) +
  geom_boxplot()+
  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))+
  labs(x = 'Video Category', y = 'Log Views', title = 'Video Category vs Log View Count')
```

While we will not include all of the plots from our exploratory data analysis, we identified quite a few variables that we thought may be useful for our final model. In addition to those mentioned above, these included the variables `subscriberCount`, `comments_disabled`, `ratings_disabled`, `num_caps`, `num_exc`, `num_period`, `num_dollar`, `desc_length`, `hour_published`, `weekday_published`, `video_length`.

```{r echo = FALSE}
library(corrplot)
library(RColorBrewer)
youtube_num <- youtube %>%
  subset(select = -c(publishedAt, view_count, comments_disabled, ratings_disabled, desc_length, weekday_published, category))
M <-cor(youtube_num)
corrplot(M, type="upper", method="color")
```

## Regression Analysis

## Discussion

## Limitations

## Conclusion

## Additional Work

